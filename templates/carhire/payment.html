{% extends 'base.html' %}
{% load static %}

{% block title %}Payment - MOTRAYLEV Car Services{% endblock %}

{% block extra_css %}
<style>
    .payment-container { max-width: 800px; margin: 0 auto; padding: 20px; }
    .booking-summary { background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 30px; border-left: 4px solid #007bff; }
    .payment-form { background: white; border-radius: 10px; padding: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .payment-methods { display: flex; justify-content: space-around; margin: 20px 0; padding: 20px; background: #f8f9fa; border-radius: 8px; }
    .payment-method { text-align: center; padding: 10px; }
    .payment-method img { height: 30px; margin-bottom: 5px; }
    .amount-display { font-size: 2rem; font-weight: bold; text-align: center; margin: 20px 0; padding: 20px; background: linear-gradient(135deg, #007bff, #0056b3); color: white; border-radius: 10px; }
    .pay-button { width: 100%; padding: 15px; font-size: 1.2rem; font-weight: bold; background: linear-gradient(135deg, #28a745, #20c997); border: none; border-radius: 8px; color: white; transition: all 0.3s ease; }
    .pay-button:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3); }
    .pay-button:disabled { background: #6c757d; cursor: not-allowed; transform: none; box-shadow: none; }
    .loading-spinner { display: none; text-align: center; margin: 20px 0; }
    .security-info { background: #e7f3ff; border: 1px solid #b3d9ff; border-radius: 8px; padding: 15px; margin: 20px 0; }
    .security-info i { color: #007bff; margin-right: 10px; }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="payment-container">
        <h2 class="text-center mb-4"><i class="fas fa-credit-card"></i> Complete Your Payment</h2>

        <!-- Booking Summary -->
        <div class="booking-summary">
            <h4><i class="fas fa-car"></i> Booking Summary</h4>
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Vehicle:</strong> {{ booking.vehicle.year }} {{ booking.vehicle.make }} {{ booking.vehicle.model }}</p>
                    <p><strong>Pickup:</strong> {{ booking.pickup_location }}</p>
                    <p><strong>Drop-off:</strong> {{ booking.dropoff_location }}</p>
                </div>
                <div class="col-md-6">
                    <p><strong>Start Date:</strong> {{ booking.start_date|date:"M d, Y H:i" }}</p>
                    <p><strong>End Date:</strong> {{ booking.end_date|date:"M d, Y H:i" }}</p>
                    <p><strong>Duration:</strong> {{ booking.total_days }} day{{ booking.total_days|pluralize }}</p>
                    <p><strong>Drive Type:</strong> {{ booking.get_drive_type_display }}</p>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-md-8"><strong>Total Amount:</strong></div>
                <div class="col-md-4 text-right"><strong>KES {{ booking.total_cost }}</strong></div>
            </div>
        </div>

        <!-- Payment Form -->
        <div class="payment-form">
            <div class="amount-display">
                Total: KES {{ booking.total_cost }}
            </div>

            <div class="payment-methods">
                <div class="payment-method">
                    <i class="fas fa-mobile-alt fa-2x text-success"></i>
                    <div>M-Pesa</div>
                </div>
            </div>

            <form id="payment-form" method="post" action="{% url 'payment' booking.booking_id %}">
                {% csrf_token %}
                {{ form.as_p }}

                <button type="submit" id="pay-button" class="pay-button">
                    <i class="fas fa-lock"></i> Pay KES {{ booking.total_cost }} Securely
                </button>
            </form>
        </div>
    </div>
</div>
{% endblock %}
